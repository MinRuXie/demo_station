!function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(e,n,t){"use strict";t.r(n),t.d(n,"colors",(function(){return o})),t.d(n,"key_ivory",(function(){return i})),t.d(n,"key_ebony_b",(function(){return s})),t.d(n,"key_ebony_h",(function(){return a})),t.d(n,"simple_ivory",(function(){return l})),t.d(n,"simple_ebony_b",(function(){return c})),t.d(n,"simple_ebony_h",(function(){return d}));const o=["#828282","#AD766A","#D5404A","#FFB11B","#90B44B","#58B2DC","#005CAF","#A8497A","#E87A90"],i=["A0","B0","C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7","D7","E7","F7","G7","A7","B7","C8"],s=["Bb0","Db1","Eb1","Gb1","Ab1","Bb1","Db2","Eb2","Gb2","Ab2","Bb2","Db3","Eb3","Gb3","Ab3","Bb3","Db4","Eb4","Gb4","Ab4","Bb4","Db5","Eb5","Gb5","Ab5","Bb5","Db6","Eb6","Gb6","Ab6","Bb6","Db7","Eb7","Gb7","Ab7","Bb7"],a=["Ah0","Ch1","Dh1","Fh1","Gh1","Ah1","Ch2","Dh2","Fh2","Gh2","Ah2","Ch3","Dh3","Fh3","Gh3","Ah3","Ch4","Dh4","Fh4","Gh4","Ah4","Ch5","Dh5","Fh5","Gh5","Ah5","Ch6","Dh6","Fh6","Gh6","Ah6","Ch7","Dh7","Fh7","Gh7","Ah7"],l=["1","2","3","4","5","6","7"],c=["b2","b3","b5","b6","b7"],d=["#1","#2","#4","#5","#6"]},function(e,n,t){"use strict";t.r(n),t.d(n,"i18n",(function(){return o}));const o=new VueI18n({locale:"tc",messages:{en:{text:{__song_title:"Please enter the song title.",__song_title_point:"Double click can modify the song title."},toolbox:{__delete_note:"Delete this note",__space_note:"Space note",__add_line:"Add new note track",__copy_line:"Copy this note track",__break_line:"Break this note track",__move_up_line:"Move this note track up",__move_down_line:"Move this note track down",__show_piano:"Open the piano",__hidden_piano:"Close the piano",__switch_mode:"Switch Mode",__output_result:"Output as picture",__function_description:"How to use?",__switch_lang:"繁體中文"},colorarea:{__color_title:"Please choose a color.",__check:"OK",__cancel:"Cancel"},notice:{__size_warn:"Please turn the phone to landscape.",__capturing:"Working..."},features:{rule:{__title:"Features Introduction",__item_1:"Enter the song title: Double click song title can enter or modify it.",__item_2:'Switch Mode: Switch the display mode of the sheet music panel, there are "numbered notation" and "stave". (Default: Numbered Notation)',__item_3:"Output an image file: The result will be displayed on the screen, and the image file can be saved.",__item_4:{__summary:'Move "Focus": Click Note track or Note can move focus. When the element get focus, its surroundings will glow.',__details:["Note track focus (up: W, down: S): When Note track get focus, the last note of it will get focus too.","Note focus (left: A, right: D): When Note get focus, its note track will get focus too."]}},note:{__title:"Note",__item_1:"Add / Insert: Press the keyboard of piano will create a note behind the focus note, and play the audio.",__item_2:'Space note (Space): Add a hollow note behind "the focused note".',__item_3:"Delete note (Backspace): Delete a focused note."},track:{__title:"Note Track",__item_1:"Add new note track (Enter): Add a new empty note track.",__item_2:'Copy this note track: Copy "the focused track and its notes" behind itself.',__item_3:'Break this note line: Break the "Focus Track" into a new two-line track based on the index of "Focus Note". The first line is from the beginning to before the focus note, and the second line is from the focus note to the end.',__item_4:'Move this note track up: Move the order of "the focused track" up.',__item_5:'Move this note track down: Move the order of "the focused track" down.',__item_6:"Change left side color of note track: Double click note track can change color (white, yellow, green, purple, orange).",__item_7:'Delete specific note track: Click right top side "x" button of note track, can delete note track and notes inside of it.'}}},tc:{text:{__song_title:"請輸入歌名",__song_title_point:"雙擊修改歌名"},toolbox:{__delete_note:"刪除音符",__space_note:"空格音符",__add_line:"新增一行",__copy_line:"複製此行",__break_line:"斷開此行",__move_up_line:"上移此行",__move_down_line:"下移此行",__show_piano:"開啟鋼琴",__hidden_piano:"關閉鋼琴",__switch_mode:"切換模式",__output_result:"輸出圖片",__function_description:"功能說明",__switch_lang:"English"},colorarea:{__color_title:"請選擇顏色",__check:"確定",__cancel:"取消"},notice:{__size_warn:"直式不可以看",__capturing:"努力處理中..."},features:{rule:{__title:"使用說明",__item_1:"輸入歌名：雙擊歌名區塊，可輸入或修改歌名。",__item_2:"切換模式：可以在簡譜及五線譜之間切換。",__item_3:"輸出圖片：將完成的作品輸出成一張圖片預覽在畫面上，右鍵可另存圖檔。",__item_4:{__summary:"移動「焦點」：點擊軌道或音符可移動焦點，成為焦點的元素周圍會有發光造型。",__details:["軌道焦點（鍵盤快捷鍵 [上：W，下：S]）：當軌道獲得焦點，軌道中的最後一個音符也會獲得焦點。","音符焦點（鍵盤快捷鍵 [左：A，右：D]）：當音符獲得焦點，音符所在軌道也會獲得焦點。"]}},note:{__title:"音符",__item_1:"新增/插入音符：點擊鋼琴琴鍵，會於畫面上的「焦點音符後方」產生音符，並播放音檔。",__item_2:"空格音符（鍵盤快捷鍵 [Space]）：增加一個空心音符於「焦點音符後方」。",__item_3:"刪除音符（鍵盤快捷鍵 [Backspace]）：刪除一個「焦點音符」。"},track:{__title:"音符軌道",__item_1:"新增一行（鍵盤快捷鍵 [Enter]）：增加一行空白軌道。",__item_2:"複製此行：複製「焦點軌道和其音符」於其後方。",__item_3:"斷開此行：將「焦點軌道」中，以「焦點音符」的索引為基準，斷開成新的兩行軌道。第一行為開頭至焦點前，第二行為焦點至結尾。",__item_4:"上移此行：將「焦點軌道」往上移動。",__item_5:"下移此行：將「焦點軌道」往下移動。",__item_6:"改變軌道顏色：雙擊軌道區塊，可改變軌道左側的邊線顏色（白、黃、綠、紫、橘）。",__item_7:"刪除指定軌道：點擊軌道右上方的叉叉按鈕，可刪除該軌道及內容。"}}}}});new Vue({el:"#app",i18n:o,methods:{switchLanguage:function(){let e=this.$i18n.locale;this.$i18n.locale="tc"==e?"en":"tc"}}})},function(e,n,t){t(3),t(0),e.exports=t(1)},function(e,n,t){"use strict";t.r(n);var o=t(0),i=t(1);$((function(){setTimeout((function(){$(".loading").fadeOut()}),1e3);let e=$(".piano"),n=$(".slide"),t=$(".text"),s=t.find(".number-panel"),a=t.find(".tabs-panel"),l=$(".toolbox"),c=$(".toolbutton"),d=$("#toolbox-btn"),r=$("#js-note-remove"),_=$("#js-note-space"),u=$("#js-line-add"),p=$("#js-line-copy"),f=$("#js-line-break"),h=$("#js-line-move-up"),b=$("#js-line-move-down"),y=$("#js-piano-show"),v=$("#js-piano-hide"),k=$("#js-switch-panel"),m=$("#js-ouput-result"),g=$("#js-intro"),C=($("#js-switch-lang"),$(".colorarea")),w=$(".intro-wrap"),x=$(".intro-wrap .ctr-btn"),A=$(".screenshot-wrap"),D=$(".screenshot-wrap .ctr-btn"),B=0,E=$(".note.selected"),F=$(".line.selected");function G(){E=$(".note.selected"),F=$(".line.selected")}function j(e,n){e.find(".line").removeClass("selected"),e.find(".note").removeClass("selected"),n.addClass("selected"),n.parent(".line").addClass("selected"),G()}function M(e,n,t,o){let i=e.find(".line.selected"),l=e.find(".note.selected");e.find(".note").removeClass("selected");let c="whitespace"!=t?t.replace(/h/,"#"):t,d=`<div data-key="${t}" title="${c}" class="note selected ${t}" style="background-color: ${o};"><span style="background-color: ${o};">${n}</span></div>`;0!=l.length?l.after(d):i.append(d),e.find(".note.selected").on("click",(function(n){let t=i.index(),o=$(this).index();switch(e){case s:o++;break;case a:o--}j(e.siblings(".panel"),e.siblings(".panel").find(".line").eq(t).children().eq(o)),j(e,$(this))})),G()}function I(e){let n=e.find(".note.selected"),t=n.prev(".note"),o=n.next(".note");0!=t.length?t.addClass("selected"):0!=o.length&&o.addClass("selected"),n.remove(),G()}function P(e,n){n.hasClass("selected")||(e.find(".line").removeClass("selected"),e.find(".note").removeClass("selected"),n.addClass("selected"),n.find(".note").last().addClass("selected"),G())}function S(e,n){if(e.find(".line").length>1){let t=n.prev(".line"),o=n.next(".line");e.find(".line").removeClass("selected"),e.find(".note").removeClass("selected"),0!=t.length?(t.find(".note").last().addClass("selected"),t.addClass("selected")):0!=o.length&&(o.find(".note").last().addClass("selected"),o.addClass("selected")),n.remove()}else e.find(".line").removeClass("selected"),e.find(".note").removeClass("selected"),n.children().not(".del").not(".line-bg").not(".play").remove(),n.addClass("selected");G()}function O(e){let n='\n            <div class=\'line selected\' title=\'雙擊修改區塊顏色\'>\n                <div class="del" title="刪除">X</div>\n                <div class="play" title="播放">▶</div>\n            </div>';e==a&&(n='\n                <div class=\'line selected\' title=\'雙擊修改區塊顏色\'>\n                    <div class=\'line-bg\'><span></span><span></span><span></span><span></span><span></span></div>\n                    <div class="del" title="刪除">X</div>\n                    <div class="play" title="播放">▶</div>\n                </div>');let t=e.find(".line.selected");e.find(".line.selected").removeClass("selected"),0!=t.length?t.after(n):e.append(n),e.find(".note.selected").removeClass("selected");let o=e.find(".line.selected");o.on("dblclick",(function(n){!function(e,n){C.show();var t=n.css("border-left-color"),o=K(parseInt(V(t).red),parseInt(V(t).green),parseInt(V(t).blue));$(".colorbtn").removeClass("selected"),$(".colorbtn").each((function(e){let n=$(this).css("backgroundColor"),t=K(parseInt(V(n).red),parseInt(V(n).green),parseInt(V(n).blue));o==t&&$(this).addClass("selected")}));var i=o;$(".colorbtn").on("click",(function(){var e=$(this).css("backgroundColor"),n=parseInt(V(e).red),t=parseInt(V(e).green),o=parseInt(V(e).blue);i=K(n,t,o),$(".colorbtn").removeClass("selected"),$(this).addClass("selected")})),$(".checkbtn").on("click",(function(){n.css("border-left-color",i),C.hide(),$(this).off();let t=n.index();e.siblings(".panel").find(".line").eq(t).css("border-left-color",i)}))}(e,$(this))})),o.on("click",(function(n){let t=o.index();P(e.siblings(".panel"),e.siblings(".panel").find(".line").eq(t)),P(e,o)})),o.find(".del").on("click",(function(n){let t=o.index();S(e.siblings(".panel"),e.siblings(".panel").find(".line").eq(t)),S(e,o)})),o.find(".play").on("click",(function(e){let n=[];$(this).siblings(".note").each((function(e){n.push($(this).data("key"))}));for(let e=0;e<n.length;e++)setTimeout((function(){try{N(""+n[e])}catch(e){}}),400*e)})),G()}function T(e,n){let t=e.find(".line.selected"),o="";switch(n){case"up":o=e.find(".line.selected").prev(".line"),t.insertBefore(o);break;case"down":o=e.find(".line.selected").next(".line"),t.insertAfter(o)}}function q(e,n){switch(e){case"line":let e="";"up"==n?e=F.prev(".line"):"down"==n&&(e=F.next(".line")),0!=e.length&&($(".line").removeClass("selected"),e.addClass("selected")),$(".note").removeClass("selected"),s.find(".line.selected .note").last().addClass("selected"),a.find(".line.selected .note").last().addClass("selected");break;case"note":let t="";"left"==n?t=E.prev(".note"):"right"==n&&(t=E.next(".note")),0!=t.length&&($(".note").removeClass("selected"),t.addClass("selected"))}G()}function N(e){let n=document.getElementById(e);n.pause(),n.currentTime=0,n.play()}function W(){B=e.scrollLeft()}function L(o){switch(o){case"close":t.addClass("expend"),l.addClass("expend"),e.addClass("collapsed"),n.hide(),W(),y.css("display","block"),v.css("display","none");break;case"open":t.removeClass("expend"),l.removeClass("expend"),e.removeClass("collapsed"),n.show(),e.animate({scrollLeft:B},0),y.css("display","none"),v.css("display","block")}}y.css("display","none"),e.animate({scrollLeft:"3000vw"},500),W(),function(){e.append('<div class="group_left"></div>');let n=$(".group_left");n.append(`<div class="ivory"><span>${o.simple_ivory[5]}</span></div>`),n.append(`<div class="ivory"><span>${o.simple_ivory[6]}</span></div>`),n.find("span").css({background:o.colors[0]}),n.append('<div class="ebony-wrap ebony_0"></div>');let t=n.find(".ebony_0");t.append(`<div class="ebony_child"><span>${o.simple_ebony_h[4]}</span></div>`),t.append(`<div class="ebony_child"><span>${o.simple_ebony_b[4]}</span></div>`),n.find(".ebony_child").find("span").css({background:o.colors[0]}),n.find(".ivory").each((function(e){$(this).append(`<div class="key">${o.key_ivory[e]}</div>`),$(this).append(`<audio id="${o.key_ivory[e]}" preload="auto"><source src="./dist/assets/audio/Piano.ff.${o.key_ivory[e]}.mp3" type="audio/mpeg"></audio>`)})),n.find(".ebony_0").each((function(e){t.find(".ebony_child").each((function(n){n<1?($(this).append(`<div data-name="${o.key_ebony_h[e]}" class="key">${o.key_ebony_h[e]}</div>`),$(this).append(`<audio id="${o.key_ebony_h[e]}" preload="auto"><source src="./dist/assets/audio/Piano.ff.${o.key_ebony_b[e]}.mp3" type="audio/mpeg"></audio>`)):($(this).append(`<div data-name="${o.key_ebony_b[e]}" class="key">${o.key_ebony_b[e]}</div>`),$(this).append(`<audio id="${o.key_ebony_b[e]}" preload="auto"><source src="./dist/assets/audio/Piano.ff.${o.key_ebony_b[e]}.mp3" type="audio/mpeg"></audio>`))}))}));for(let n=0;n<7;n++)e.append('<div class="group"></div>');$(".group").each((function(e){$(this).css({left:14.28+50*e+"%"});for(let e=0;e<=6;e++)$(this).append(`<div class="ivory"><span>${o.simple_ivory[e]}</span></div>`);$(this).find("span").css({background:o.colors[e+1]});for(let e=1;e<=5;e++)$(this).append(`<div class="ebony-wrap ebony_${e}"></div>`);for(let e=0;e<5;e++){let n=$(this).find(".ebony_"+(e+1));n.append(`<div class="ebony_child"><span>${o.simple_ebony_h[e]}</span></div>`),n.append(`<div class="ebony_child"><span>${o.simple_ebony_b[e]}</span></div>`)}$(this).find(".ebony_child").find("span").css({background:o.colors[e+1]}),$(this).find(".ivory").each((function(n){$(this).append(`<div class="key">${o.key_ivory[2+7*e+n]}</div>`),$(this).append(`<audio id="${o.key_ivory[2+7*e+n]}"><source src="./dist/assets/audio/Piano.ff.${o.key_ivory[2+7*e+n]}.mp3" type="audio/mpeg"></audio>`)}));for(let n=0;n<5;n++)$(this).find(".ebony_"+(n+1)).each((function(t){$(this).find(".ebony_child").each((function(t){t<1?($(this).append(`<div data-name="${o.key_ebony_h[1+5*e+n]}" class="key">${o.key_ebony_h[1+5*e+n]}</div>`),$(this).append(`<audio id="${o.key_ebony_h[1+5*e+n]}"><source src="./dist/assets/audio/Piano.ff.${o.key_ebony_b[1+5*e+n]}.mp3" type="audio/mpeg"></audio>`)):($(this).append(`<div data-name="${o.key_ebony_b[1+5*e+n]}" class="key">${o.key_ebony_b[1+5*e+n]}</div>`),$(this).append(`<audio id="${o.key_ebony_b[1+5*e+n]}"><source src="./dist/assets/audio/Piano.ff.${o.key_ebony_b[1+5*e+n]}.mp3" type="audio/mpeg"></audio>`))}))}))})),e.append('<div class="group_right"></div>');let i=$(".group_right");i.append(`<div class="ivory"><span>${o.simple_ivory[0]}</span></div>`),i.find("span").css({background:o.colors[8]}),i.find(".ivory").each((function(){$(this).append(`<div class="key">${o.key_ivory[o.key_ivory.length-1]}</div>`),$(this).append(`<audio id="${o.key_ivory[o.key_ivory.length-1]}"><source src="./dist/assets/audio/Piano.ff.${o.key_ivory[o.key_ivory.length-1]}.mp3" type="audio/mpeg"></audio>`)}))}(),O(s),O(a),$(".title").on("dblclick",(function(e){var n=function(e){var n=document.createElement("div");n.innerHTML=e;var t=n.innerText||n.textContent;return n=null,t}($(this).html()),t=prompt(i.i18n.t("text.__song_title"),n);null!=t&&$(this).text(t)})),d.on("click",(function(e){l.toggleClass("closed"),t.toggleClass("full")})),$(".cancelbtn").on("click",(function(e){C.hide()})),x.on("click",(function(e){w.removeClass("active"),g.removeClass("selected")})),D.on("click",(function(e){A.removeClass("active")}));let z=isMobile.phone?"touchstart":"mousedown",H=isMobile.phone?"touchend":"mouseup";function V(e){var n=e.match(/rgba?\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3})\)?(?:, ?(\d(?:\.\d?))\))?/);return n?{red:parseInt(n[1]),green:parseInt(n[2]),blue:parseInt(n[3])}:{}}function X(e){var n=e.toString(16);return 1==n.length?"0"+n:n}function K(e,n,t){return"#"+X(e)+X(n)+X(t)}$(".ivory").each((function(e){$(this).on(z,(function(e){$(this).css({background:"#f2f2f2"}),M(s,$(this).find("span").text(),$(this).find(".key").text(),$(this).find("span").css("background-color")),M(a,$(this).find("span").text(),$(this).find(".key").text(),$(this).find("span").css("background-color")),N($(this).find(".key").text())})).on(H,(function(e){$(this).css({background:"#fff"})}))})),$(".ebony_child").each((function(e){$(this).on(z,(function(e){$(this).css({background:"#444"}),M(s,$(this).find("span").text(),$(this).find(".key").data("name"),$(this).find("span").css("background-color")),M(a,$(this).find("span").text(),$(this).find(".key").data("name"),$(this).find("span").css("background-color")),N($(this).find(".key").text())})).on(H,(function(e){$(this).css({background:"#000"})}))})),c.each((function(e){$(this).on(z,(function(e){$(this).addClass("selected")})).on(H,(function(e){$(this).removeClass("selected")}))})),r.on(z,(function(e){I(s),I(a)})),_.on(z,(function(e){M(s,"","whitespace","rgba(255, 255, 255, 0.2)"),M(a,"","whitespace","rgba(255, 255, 255, 0.2)")})),u.on(z,(function(e){O(s),O(a)})),p.on(z,(function(e){!function(){let e=F.eq(0).contents().not(".del").not(".line-bg").not(".play").clone();O(s),O(a);for(let n=0;n<e.length;n++){let t=e.eq(n);M(s,t.text(),t.data("key"),t.css("background-color")),M(a,t.text(),t.data("key"),t.css("background-color"))}G()}()})),f.on(z,(function(e){!function(){let e=F.eq(0),n=e.find(".note.selected").index(".selected .note"),t=e.find(".note").first().index(".selected .note"),o=e.find(".note").last().index(".selected .note"),i=e.contents().not(".del").not(".line-bg").not(".play").slice(t,n).clone();O(s),O(a);for(let e=0;e<i.length;e++){let n=i.eq(e);M(s,n.text(),n.data("key"),n.css("background-color")),M(a,n.text(),n.data("key"),n.css("background-color"))}let l=e.contents().not(".del").not(".line-bg").not(".play").slice(n,o+1).clone();O(s),O(a);for(let e=0;e<l.length;e++){let n=l.eq(e);M(s,n.text(),n.data("key"),n.css("background-color")),M(a,n.text(),n.data("key"),n.css("background-color"))}G()}()})),h.on(z,(function(e){T(s,"up"),T(a,"up")})),b.on(z,(function(e){T(s,"down"),T(a,"down")})),y.on(z,(function(e){L("open")})),v.on(z,(function(e){L("close")})),k.on(z,(function(e){s.toggleClass("open"),a.toggleClass("open")})),m.on(z,(function(e){A.addClass("active"),function(){let e=$("#capture");e.addClass("capturing"),e.scrollTop(0);let n=$("#output");n.empty(),html2canvas(document.querySelector("#capture")).then((t=>{n.append(t),e.removeClass("capturing")}))}()})),g.on(z,(function(e){w.addClass("active")})),isMobile.phone||$(window).on("keydown",(function(e){switch(e.keyCode){case 8:I(s),I(a);break;case 13:O(s),O(a);break;case 32:M(s,"","whitespace","rgba(255, 255, 255, 0.2)"),M(a,"","whitespace","rgba(255, 255, 255, 0)");break;case 65:q("note","left");break;case 87:q("line","up");break;case 68:q("note","right");break;case 83:q("line","down")}}))}))}]);